stages:
- stage: push_nuget
  displayName: Push to NuGet
  jobs:
  - job: push_consoleapp
    displayName: Push Console Application as DotNet Tool
    steps:
    - task: DotNetCoreCLI@2
      displayName: Package Projects
      inputs:
        command: pack
        outputDir: $(Build.ArtifactStagingDirectory)
    - task: PublishBuildArtifacts@1
      displayName: Publish Package Artifacts
      inputs:
        pathtoPublish: $(Build.ArtifactStagingDirectory)
        artifactName: packages
    - task: NuGetCommand@2
      displayName: Push Console Application to NuGet
      inputs:
        command: 'push'
        packagesToPush: '$(Build.ArtifactStagingDirectory)/**/*.nupkg'
        nuGetFeedType: 'internal'
        publishVstsFeed: 'c79f77f7-f1e6-49fa-b96b-6aca86a55d4b/7078f1f7-33dd-4239-936c-03b27c54e5a6'
        allowPackageConflicts: true