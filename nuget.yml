stages:
- stage: push_nuget
  displayName: Push to NuGet
  jobs:
  - job: push_consoleapp
    displayName: Push Console Application as DotNet Tool
    steps:
    - task: DotNetCoreCLI@2
      displayName: Package Console Application
      inputs:
        command: pack
        outputDir: $(Build.ArtifactStagingDirectory)
    - task: PublishBuildArtifacts@1
      displayName: Publish Package Artifacts
      inputs:
        pathtoPublish: $(Build.ArtifactStagingDirectory)
        artifactName: packages
    - task: NuGetCommand@2
      displayName: Push Console Application to NuGet
      inputs:
        command: push
        feedsToUse: select
        vstsFeed: Munsons/Farm
        packagesToPush: $(Build.ArtifactStagingDirectory)/*.nupkg